---
import { Image } from 'astro:assets';
import type { CollectionEntry } from 'astro:content';
import type { Project } from '~/content/types';
import { ProjectType } from '~/content/projects';
import BaseCard from '@components/shared/BaseCard.astro';

interface Props {
  project: CollectionEntry<Project>;
}

const { project } = Astro.props;

const coverImage = project.data.coverImage.split('.');
const variant = project.data.type === ProjectType.Personal ? 'default' : 'primary';
const isPersonal = project.data.type === ProjectType.Personal;
---

<BaseCard
  href={`/work/${project.slug}`}
  variant={variant}
  class="overflow-hidden h-full flex flex-col hover:scale-[1.02] transition-transform duration-200"
>
  {
    !isPersonal && (
      <div class="flex items-center justify-center w-full bg-white h-56 overflow-hidden">
        <Image
          src={
            (await import(`./../../assets/images/projects/${project.slug}/${coverImage[0]}.${coverImage[1]}`)).default
          }
          alt={`Image of project: ${project.data.name}`}
          class="object-contain w-full h-full p-6"
          loading="eager"
          aria-hidden="true"
        />
      </div>
    )
  }

  <div class="px-6 py-5 flex-1 flex flex-col">
    <h3 class="font-bold text-xl mb-3 line-clamp-2">
      {project.data.name}
    </h3>

    <p class="line-clamp-3 opacity-80 text-sm leading-relaxed flex-1">
      {project.data.description}
    </p>

    <div class="mt-4 pt-4 border-t border-current border-opacity-10">
      <span class="text-sm font-medium opacity-70">View details â†’</span>
    </div>
  </div>
</BaseCard>
