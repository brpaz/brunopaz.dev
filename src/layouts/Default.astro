---
import Header from '~/components/shared/Header.astro';
import Footer from '~/components/shared/Footer.astro';
import CrispChat from '~/components/shared/CrispChat.astro';

import siteData from '~/data/site.json';

const monetizationUrl = import.meta.env.PUBLIC_WEB_MONETIZATION_ID || "";
const sentryEnabled = import.meta.env.PUBLIC_SENTRY_ENABLED || false;
const sentryKey = import.meta.env.PUBLIC_SENTRY_KEY || "";
const chatEnabled = import.meta.env.PUBLIC_CHAT_ENABLED || false;
const crispWebsiteId = import.meta.env.PUBLIC_CRISP_WEBSITE_ID || "";

let title = Astro.props.title || siteData.title;
let description = Astro.props.description || siteData.description;

let sitePreviewImage = Astro.props.previewImage || `${Astro.site.origin}/img/site-preview.png`

---
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>{title}</title>
    <meta name="description" content={description}/>
    <meta name="monetization" content={monetizationUrl}/>
    <meta property="og:url" content={Astro.request.url}>
    <meta property="og:image" content={sitePreviewImage}>
    <meta property="og:type" content="website">
    <meta name="twitter:card" content="summary">
    <meta name="twitter:creator" content={siteData.social.twitter.handle} />
    <meta name="twitter:app:country" content="PT">
    <meta name="twitter:title" property="og:title" itemprop="title name" content={title} />
    <meta name="twitter:description" property="og:description" itemprop="description" content={description} />
    <meta name="twitter:image" content={sitePreviewImage}>
    <link rel="canonical" href={Astro.request.canonicalURL.toString().slice(0,-1)} />
    <link rel="icon" type="image/png" href="/favicon.png" />
    <link rel="alternate" type="application/rss+xml" title="RSS Feed for brunopaz.dev" href="/feed.xml" />

    <link rel="stylesheet" href={Astro.resolve('../assets/styles/global.css')}>

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link rel="preload" href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;700&display=swap"
      as="style"
      onload="this.onload=null;this.rel='stylesheet'"/>

    <noscript>
      <link
          href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;700&display=swap"
          rel="stylesheet"
          type="text/css"
      />
    </noscript>

    <script type="module" src={Astro.resolve('../assets/scripts/app.js')} defer></script>

    {sentryEnabled &&
      <script src={`https://js.sentry-cdn.com/${sentryKey}.min.js`}
      crossorigin="anonymous" defer
    ></script>

    }
</head>
<body class="h-screen w-full flex flex-col text-neutral-600">
   <main id="swup" class="container mx-auto mb-auto pb-16 p-4">
        <Header />

        <!-- The page will render it's content here -->
        <slot />
   </main>
    <Footer />

    {(chatEnabled && crispWebsiteId !== "" ) &&
      <CrispChat websiteId={crispWebsiteId} />
    }
  </body>

</html>
